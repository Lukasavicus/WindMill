{% extends 'layout.html' %}

{% block content %}
	<div class="container">
		<section id="upload-scripts">
		<form method=post enctype=multipart/form-data>

			<div class="form-group col-sm-7">
			    <label for="venvName">Virtual Enviroment</label>
			    <select type="text" class="form-control" id="venvName" name="venvName" aria-describedby="venvName" placeholder="Enter task name">

			    </select>
			</div>

			<input type=file name=file>
			<input type=submit value=Upload>
		</form>
		</section>
		<script type="text/javascript">
			function get_paths(path=''){

				const base_path = '/api/fs';

				let path_to_fetch = base_path + path;

				fetch(path_to_fetch)
				.then(response => {
				    if(response.ok)
				        return response.json();
				    throw new Error(response);
				})
				.then(data => {
					set_select(data['files_info']);
					set_breadcrumbs(data['locations']);
				});
			}

			function set_select(data){
				//console.log("data input", data);
				let select = document.querySelector("#venvName");
				
				Array.from(select.children).forEach((child) => select.removeChild(child));
				data = [{'name' : ''}].concat(data);

				data.forEach((d) => {
					let opt = document.createElement('option');

					opt.appendChild( document.createTextNode(`${d['name']}`));
					opt.value = d['path'];
					select.appendChild(opt);
				});
			}

			get_paths();
		</script>
	</div>
{% endblock %}